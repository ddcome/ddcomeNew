<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="./script-packages/imgs/logo.jpg">

<title>DDCOME</title>

<!-- Bootstrap core CSS -->
<link rel="stylesheet" href="./script-packages/bootstrap-4/css/bootstrap.min.css">
<link href="./script-packages/css/main.css" rel="stylesheet">
<link href="./script-packages/css/style.css" rel="stylesheet">
<link href="./script-packages/fonts/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="./script-packages/css/share.css" rel="stylesheet">
<link href="./script-packages/css/loading/loading.css" rel="stylesheet">
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="./script-packages/bootstrap/assets/js/ie10-viewport-bug-workaround.js"></script>
</head>
<body>
	<!-- 导航栏 -->
	<div class="header-nav-ostyle">
			<ul class="nav justify-content-center h5">
				<li class="nav-item active"><a class="nav-link text-dark" href="index.html">Home <span class="sr-only">(current)</span></a></li>
				<li class="nav-item"><a class="nav-link text-dark" href="docs.html">Notes</a></li>
				<li class="nav-item"><a class="nav-link text-dark" href="mylife.html">My Life</a></li>
				<li class="nav-item"><a class="nav-link text-dark" href="contact.html">Contact</a></li>
			</ul>
	</div>
	<!-- 占位 -->
	<div class="container" style="height: 50px; ">
		<div class="row">&nbsp;</div>
	</div>
	<div class="content-wrapper">
		<div class="container">

			<div class="row">

				<div class="col-md-4">
					<div class="card">
						<div class="card-header"><i class="fa fa-book" aria-hidden="true"></i>&nbsp;&nbsp;Books</div>
						<div class="card-body">
							<ul class="ul-ostyle" id="books-ul">
							</ul>
							<!-- Loading加载效果 -->
							<div id="loading-books" class="spinner">
								<div class="rect1"></div>
								<div class="rect2"></div>
								<div class="rect3"></div>
								<div class="rect4"></div>
								<div class="rect5"></div>
							</div>
						</div>
					</div>
					<div class="col-md-12 clear-distance-ostyle"></div>
					<!--友情链接-->
					<div class="card backg-ostyle">
						<div class="card-header">
							<span style="font-size: 17px;"> <i class="fa fa-magnet">&nbsp;</i>
							友情链接
							</span>
						</div>
						<div class="card-body">
							<div class="arcticle-side-class">
								<ul style="padding-left: 0px;">
									<li></li>
									<li><a href="https://http://blog.csdn.net/">CSDN博客</a></li>
									<li><a href="https://www.ibm.com/developerworks/cn/java/">IBM技术主题之Java开发</a></li>
									<li><a href="http://www.javascriptsource.com">JavaScript
											Resource</a></li>
									<li><a href="#">ThinkPHP</a></li>
									<li><a href="http://weekly.manong.io/">码农周刊</a></li>
									<li><a href="https://www.cppfans.org/">C++爱好者</a></li>
									<li><a href="http://www.raychase.net/">四火的唠叨 </a></li>
									<li><a href="https://helloacm.com/">HelloGcc Working
											Group </a></li>
								</ul>
							</div>
						</div>
					</div>
					
					<div id="user-info-div" class="card backg-ostyle">
						<div class="card-body">
							<div class="arcticle-side-class"
								style="text-align: center; align: center;">
								<span style="font-size: 17px;"><i
									class="fa fa-user-circle-o" aria-hidden="true"></i> </span>
								<ul id="user-info-ul" style="padding-left: 0px;">
									<li>未登录</li>
								</ul>
							</div>
						</div>
					</div>
				</div>


				<div class="col-md-8">

					<nav aria-label="breadcrumb">
					  <ol class="breadcrumb">
					    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
					    <li class="breadcrumb-item"><a href="docs.html">Notes</a></li>
					    <!-- <li class="breadcrumb-item active" aria-current="page">Data</li> -->
					  </ol>
					</nav>
					<div class="col-md-12 clear-distance-ostyle"></div>
					<div class="card backg-ostyle">
						<div id="pdf-info" class="card-header card-title-ostyle"></div>
						<div class="card-body">
							<div id="pdf-div" style="height: 700px;">

							</div>
						</div>
					</div>
					<div class="col-md-12 clear-distance-ostyle"></div>
					<div class="card backg-ostyle">
						<div class="card-body">
							<!-- 内容末尾处 -->
							<div class="detail-bullhorn-class">
								<span><i class="fa fa-bullhorn"></i>&nbsp;&nbsp;<strong>版权声明：</strong>除个别说明外，本站所有文章均是<a
									href="http://www.ddcome.cn">ddcome博客</a>原创，转载请标注本站URL地址。</span>
							</div>
						</div>
					</div>
					<div class="col-md-12 clear-distance-ostyle"></div>

					<div class="card backg-ostyle">
						<div class="card-body">
							<!-- 
							<div style="border: 1px solid #D3D3D3; background-color:#D3D3D3; height:38px; border-radius: 10px; line-height:38px; text-align:center;">
								<a href="javascript:showVisitorLoginDiv();" style="color:#000;text-decoration: none;">
									<i class="fa fa-angle-down" aria-hidden="true" style="font-size:25px;"></i>
								</a>
							</div>
							 -->
							<div id="visitor-login-div" class="detail-message-class"
								style="margin-top: 10px;">
								<div class="detail-message-panel-class">
								
									<div id="words-login-div">
										<a href="javascript:changeloginWay(1);">使用QQ登录</a>
										&nbsp;&nbsp;&nbsp;
										<a href="javascript:changeloginWay(0);">使用邮箱登录</a>
									</div>
								
									<div style="border-bottom: 1px solid #aaa;margin-bottom:10px;">
									</div>
									
									<div id="qq-comment-div" class="detail-message-body-class">
										<!-- <label>留言内容:</label> -->
										<textarea id="qq-comment-content" rows="4" class="form-control"
											placeholder="若有疑问或指导，欢迎您的留言"></textarea>
										<button id="comment-btn" class="btn btn-success login-btn-ostyle" onclick="commentByQQ()" disabled>
											<span class="glyphicon glyphicon-envelope"></span> 评论
										</button>
										&nbsp;&nbsp;&nbsp;
										<a id="qq-login-btn" class="btn btn-warning login-btn-ostyle"
											 href="javascript: giveAuthorityToQQ();"><span class="fa fa-qq"></span> &nbsp;&nbsp;授权QQ发言</a>
									</div>
									
									<div id="email-comment-div" class="detail-message-body-class" style="display: none;">
										<p>
											<label>邮箱:</label> <input id="mail-name" type="text"
												class="form-control" />
										</p>
										<p id="mail-warn" style="color:red;display:none; font-size: 10px; align: right; text-align: right;">
											请输入或输入正确的邮箱地址！
										</p>
										<p>
											<label>名称:</label> <input id="mail-short-name" type="text"
												class="form-control" placeholder="这里可以自动生成哦，是加密的邮箱名" />
										</p>
										<p>
											<label><a href="javascript: sendMail();">点击获取邮箱验证码:</a></label>
											<input id="identy-code-input" type="text" class="form-control"
												placeholder="点击后，请您去邮箱查看验证码，在这里输入" />
										</p>
										<p id="identy-warn" style="color:red;display:none; font-size: 10px; align: right; text-align: right;">
											请输入或输入正确的验证码！
										</p>
										<!-- <label>留言内容:</label> -->
										<textarea id="email-comment-content" rows="4" class="form-control"
											placeholder="若有疑问或指导，欢迎您的留言"></textarea>
										<button class="btn btn-success login-btn-ostyle" onclick="commentByEmail()">
											<span class="glyphicon glyphicon-envelope"></span>评论
										</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-12 clear-distance-ostyle"></div>
					<div class="card backg-ostyle">
						<div class="card-body card-title-ostyle">
							<h4
								style="background-color: #D3D3D3; border-radius: 10px; padding-left: 10px; padding-top: 5px; padding-bottom: 5px;">
								<i class="fa fa-coffee"></i>&nbsp;&nbsp;本文评论
							</h4>
						</div>
						<div class="card-body">
							<!--评论模块-->
							<ul id="detail-comment-class" style="padding-left:20px;">
								<p style="text-align:center;"><img src="script-packages/imgs/no_comment.png"></p>
							</ul>
						</div>
					</div>
					<div class="col-md-12 clear-distance-ostyle"></div>
				</div>

			</div>

		</div>
	</div>
	
	
	<!-- CONTENT-WRAPPER SECTION END-->
	<footer id="footer-ostyle">
		<div>
			<a href="https://github.com/ddcome" class="footer-ostyle-github" style="font-size: 25px;color: #111;"><i class="fa fa-github" aria-hidden="true"></i></a><br>
			&copy;2014-2018 版权归ddcome博客所有&nbsp;<i class="fa fa-registered" aria-hidden="true"></i>支持原创<br>
			<i class="fa fa-shield" aria-hidden="true"></i>蒙ICP备14004842号-2<br>
			lxd_ddcome@163.com
		</div>
	</footer>
	<!-- FOOTER SECTION END-->
	<!-- JAVASCRIPT AT THE BOTTOM TO REDUCE THE LOADING TIME  -->
	<!-- CORE JQUERY SCRIPTS -->
	<script src="./script-packages/js/jquery-1.11.1.js"></script>
	<script src="./script-packages/js/jquery.cookie.js"></script>
	<script src="./script-packages/js/jquerysession.js"></script>
	<!-- BOOTSTRAP SCRIPTS  -->
	<script src="./script-packages/bootstrap-4/js/bootstrap.min.js"></script>
	<script src="./script-packages/bootstrap/dist/js/bootstrap-modal.js"></script>
	<script src="./script-packages/js/own/authority.js"></script>
	<script src="./script-packages/js/pdf/jquery.media.js"></script>
	<script src="./script-packages/js/pdf/jquery.metadata.js"></script>
	<script src="./script-packages/js/own/share.own.js"></script>
	<script src="./script-packages/js/own/emailAuthority.js"></script>
	<!--JS脚本-->
	<script>
		var times = 0;
		var userInfo;
		var _data;

		$(function() {
			
			//绑定区域
			$('#mail-name').bind('input propertychange', function() {  
			    var mailAddress = $("#mail-name").val().trim();
				
				if (mailAddress == "" || !isEmail(mailAddress)) {
					$("#mail-warn").css("display","block");
				} else {
					$("#mail-warn").css("display","none");
					var str = mailAddress.substring(0,mailAddress.indexOf("@"));
					$("#mail-short-name").val(str);
				}
			});  

			times = 0;
			//$("#visitor-login-div").hide();
			//获取Get方式的参数
			var id = GetQueryString("id");
			var res = find(id);
			_data = res;
			
			loadData(res);
			loadReply(res);
			
			//检查权限部分
			hideUserInfoDiv();
			
			var qqUserInfo = checkAuthority();
			userInfo = qqUserInfo;
			addUserInfoCont(qqUserInfo);
			
			if(authority) {
				showUserInfoDiv();
				$("#comment-btn").removeAttr("disabled"); 
				$("#qq-login-btn").css("display","none");
			}

            //接着查询书
            findBooks();
			//记录IP
			//recordIP();
		});
		
		function showUserInfoDiv() {
			$("#user-info-div").css("display","block");
		}
		
		function hideUserInfoDiv() {
			$("#user-info-div").css("display","none");
		}

        function addUserInfoCont(qqUserInfo) {
            $("#user-info-ul").empty();
            var cont = "";
            if (qqUserInfo && qqUserInfo.name_qq) {
                cont +=
                    '<li>尊敬的'+qqUserInfo.name_qq+'，您好！</li>'+
                    //'<li>您上次登录时间： 2017/08/09</li>'+
                    '<li>您对本站评论了0条</li>'+
                    '<li>多谢晒！</li>';
            }
            $("#user-info-ul").append(cont);
        }
		
		function showQQDiv() {
			$("#email-comment-div").css("display","none");
			$("#qq-comment-div").css("display","block");
		}
		
		function showEmailDiv() {
			$("#email-comment-div").css("display","block");
			$("#qq-comment-div").css("display","none");
		}
		
		function changeloginWay(flag) {
			if(flag==0) {
				showEmailDiv();
			} else {
				showQQDiv();
			}
		}
		
		function giveAuthorityToQQ() {
			/*
			跳转之前需要清除seesion，
			记录当前页的ID
			*/
			var id = GetQueryString("id");
			window.open("/ddcomeNew/goodLuckToDd/qqEnter","","top=150,left=300,width=700,height=400");
			//$(location).attr('href','/ddcomeNew/goodLuckToDd/qqEnter');
		}
		
		/**
		* 发起请求，使用QQ身份评论
		*/
		function qqLogin() {
			$.ajax({
				async : false, //禁止异步
				url : "/ddcomeNew/goodLuckToDd/qqEnter",
				type : "post",
				data : {},
				dataType : "json",
				success : function(json) {
				},
				error : function(json) {
				}
			});
		}

		/**
		* 监听窗口的变化，以此判断PDF文件的显示器需要的宽和高
		*/
		$(window).resize(function () {          //当浏览器大小变化时
			loadData(_data);
		});
		
		function loadData(data) {
			var cont = '';
			$("#pdf-info").empty();
			cont = '<h4 class="detail-title-class">' + data[0].title + '</h4>'
					+ '<div style="border-top: 1px dotted #ddd;"></div>'
					+ '<div class="detail-status-class">' + '	<span></span> '
					+ '	<span> <i class="fa fa-user">&nbsp;</i> '
					+ '	<a href="#" title="由XXX发布" rel="author">'
					+ data[0].author + '</a>' + '	</span> &nbsp; '
					+ '	<span> <i class="fa fa-calendar">&nbsp;</i>'
					+ data[0].publish_time.substring(0, 10) + ''
					+ '	</span> &nbsp; '
					+ '	<span> <i class="fa fa-eye"></i>&nbsp;'
					+ data[0].browse_times + '' + '	</span> &nbsp; '
					+ '	<span> <i class="fa fa-tags"></i>&nbsp;' + data[0].tags
					+ '' + '	</span> &nbsp; ' + '</div>';
			$("#pdf-info").append(cont);
			$("#pdf-div").empty();
			/*
			cont = '<div style="float: left;">'
					+ '	<i class="fa fa-file" aria-hidden="true">&nbsp;&nbsp;'
					+ data[0].title
					+ '</i>'
					+ '</div>'
					+ '<div style="float: right;">'
					+ '	<a href="javascript:;" style="color: #fff;">'
					+ '	<i class="fa fa-eye" aria-hidden="true">预览</i></a> &nbsp;&nbsp; '
					+ '	<a href="javascript:;" style="color: #fff;">'
					+ '	<i class="fa fa-download" aria-hidden="true">下载</i></a>'
					+ '</div>';
			*/
			cont = '<div>'
				+ '<a class="media" href="'+data[0].file+'"></a>'
				+ '</div>';
			$("#pdf-div").append($(cont));
			var autoWidth = $("#pdf-div").width();
			var autoHeight = $("#pdf-div").height()-50;
			$('a.media').media({width:autoWidth, height:autoHeight});
		}

		/**
		 * 展示回复输入框的组件
		 */
		function showReplyInput(belongTo, id, aid, speaker) {
			//先检查权限
			if(!doUserInfoExist() || !doesEmailCodeExist()) {
				var t = $('#visitor-login-div').offset().top;//获取需要跳转到标签的top值
				$(window).scrollTop(t);//跳转到指定位置
				return;
			}
			$(".reply-input").empty();
			var replyInput = '<textarea id="words-textarea" class="form-control" type="text" placeholder="回复 '+speaker+'"></textarea><p style="text-align:right;"><button type="button" class="btn btn-success" onclick="reply('
					+ belongTo
					+ ','
					+ id
					+ ','
					+ aid
					+ ',\''
					+ speaker
					+ '\')" style="padding-top:2px; padding-bottom:2px;">回复</button></p>';
			$("#reply-input-div" + id).append($(replyInput));
		}

		/**
		 * 回复函数
		 * 需要四个参数：
		 * 1.被回复数据的belongTo
		 * 2.被回复数据的id，speakWith的值一定等于这个值
		 * 3.被回复数据的speaker
		 * 4.该文章的编号aid
		 */
		function reply(belongTo, id, aid, speaker) {
			var words = $("#words-textarea").val();
			belongTo = belongTo == -1 ? id : belongTo;
			var res;
			var params = {
				action : 'add-reply',
				data : {
					id : id,
					aid : aid,
					speaker : speaker,
					words : words,
					isTop : 0,
					belongTo : belongTo
				}
			};
			$.ajax({
				async : false, //禁止异步
				url : "/ddcomeNew/goodLuckToDd/forend",
				type : "post",
				data : {
					params : JSON.stringify(params)
				},
				dataType : "json",
				success : function(json) {
					res = json;
				},
				error : function(json) {
					res = json;
				}
			});
			//return res;
		}
		
		function clearQQComment() {
			$("#qq-comment-content").val("");
		}
		
		/**
		* QQ的评论框
		*/
		function replyByQQ(belongTo, id, aid, speaker, content) {
			belongTo = belongTo == -1 ? id : belongTo;
			var res;
			var params = {
				action : 'add-QQ-reply',
				data : {
					id : id,
					aid : aid,
					speaker : speaker,
					words : content,
					isTop : 0,
					belongTo : belongTo
				}
			};
			$.ajax({
				async : false, //禁止异步
				url : "/ddcomeNew/goodLuckToDd/forend",
				type : "post",
				data : {
					params : JSON.stringify(params)
				},
				dataType : "json",
				success : function(json) {
					res = json;
					clearQQComment();
				},
				error : function(json) {
					res = json;
				}
			});
			//return res;
		}
		
		
		
		/**
		* 邮箱的评论框
		*/
		function replyByEmail(belongTo, id, aid, speaker, content) {
			belongTo = belongTo == -1 ? id : belongTo;
			var res;
			var params = {
				action : 'add-Email-reply',
				data : {
					id : id,
					aid : aid,
					speaker : speaker,
					words : content,
					isTop : 0,
					belongTo : belongTo
				}
			};
			$.ajax({
				async : false, //禁止异步
				url : "/ddcomeNew/goodLuckToDd/forend",
				type : "post",
				data : {
					params : JSON.stringify(params)
				},
				dataType : "json",
				success : function(json) {
					res = json;
					clearQQComment();
				},
				error : function(json) {
					res = json;
				}
			});
			//return res;
		}

		function loadReply(data) {
			var cont = '';
			$("#detail-comment-class").empty();
			if(data[0].reply.length==0) {
				cont+='<p style="text-align:center;"><img src="script-packages/imgs/no_comment.png"></p>';
			}
			for (var i = 0; i < data[0].reply.length; i++) {
				cont += '<li style="margin-top:7px;">'
						+ '	<p style="color: #006030;font-weight:bold;">'
						+ '		<i class="fa fa-user-secret"></i>&nbsp;&nbsp;'
						+ data[0].reply[i].describe
						+ ''
						+ '	</p>'
						+ '	<pre><xmp>'
						+ data[0].reply[i].words
						+ '</xmp></pre>'
						+ '	<p align="right">'
						+ '		<span class="label label-pill label-default">'
						+ '	'
						+ data[0].reply[i].time.substring(0, 16)
						+ '</span>'
						+ '		<a href="javascript: showReplyInput('
						+ data[0].reply[i].belong_to
						+ ','
						+ data[0].reply[i].id
						+ ','
						+ data[0].id
						+ ',\''
						+ data[0].reply[i].speaker
						+ '\');"><span style="padding: 3px 10px 3px 10px; cursor: pointer;">'
						+ '		<i class="fa fa-comment-o">&nbsp;</i></span></a>'
						+ '	</p>'
						+ '	<div id="reply-input-div'+data[0].reply[i].id+'" class="reply-input"></div>'
						+ '</li>';
				for (var j = 0; j < data[0].reply[i].reply_array.length; j++) {
					cont += '<li style="margin-top:7px;margin-left: 50px;">'
							+ '	<p style="color: #019858;font-weight:bold;">'
							+ '		<i class="fa fa-user-secret"></i>&nbsp;&nbsp;'
							+ data[0].reply[i].reply_array[j].describe
							+ ''
							+ '	</p>'
							+ '	<pre><xmp>'
							+ data[0].reply[i].reply_array[j].words
							+ '</xmp></pre>'
							+ '	<p align="right">'
							+ '		<span class="label label-pill label-default">'
							+ '	'
							+ data[0].reply[i].reply_array[j].time.substring(0,
									16)
							+ '</span>'
							+ '		<a href="javascript: showReplyInput('
							+ data[0].reply[i].reply_array[j].belong_to
							+ ','
							+ data[0].reply[i].reply_array[j].id
							+ ','
							+ data[0].id
							+ ',\''
							+ data[0].reply[i].reply_array[j].speaker
							+ '\');"><span style="padding: 3px 10px 3px 10px; cursor: pointer;">'
							+ '		<i class="fa fa-comment-o">&nbsp;</i></span></a>'
							+ '	</p>'
							+ '	<div id="reply-input-div'+data[0].reply[i].reply_array[j].id+'" class="reply-input"></div>'
							+ '</li>';
				}
			}
			$("#detail-comment-class").append($(cont));
		}

		function initSummernote() {
			/*
			加载，初始化回复框组件 JS代码 
			 */
			$('.summernote').summernote({
				height : 150,
				tabsize : 2,
				lang : 'zh-CN'
			});
		}

		/**
		 * 查询
		 */
		function find(id_value) {
			var res;
			var params = {
				action : 'one-pdf',
				data : {
					id : id_value
				}
			};
			$.ajax({
				async : false, //禁止异步
				url : "/ddcomeNew/goodLuckToDd/forend",
				type : "post",
				data : {
					params : JSON.stringify(params)
				},
				dataType : "json",
				success : function(json) {
					/*
					$("#message").html(json.message);
					//成功跳转
					if(json.status.toString() == '1'){
						 window.location.href="index.html";
					}
					 */
					res = json;
				},
				error : function(json) {
					/*
					alert(json.message);
					$("#message").html(json.message);
					 */
					res = json;
				}
			});
			return res;
		}

		function isEmail(str) {
			var reg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;
			return reg.test(str);
		}

		function sendMail() {
			var mailAddress = $("#mail-name").val().trim();
			$("#mail-warn").css("display","none");
			if (mailAddress == "" || !isEmail(mailAddress)) {
				$("#mail-warn").html('<i class="fa fa-exclamation-circle" aria-hidden="true"></i>邮箱格式错误或为空！');
				$("#mail-warn").css("display","block");
				return;
			}
			$("#mail-short-name").val(mailAddress.substring(0,mailAddress.indexOf("@")));
			send(mailAddress);
		}

		/**
		 * 发送邮件
		 */
		function send(mailAddress) {
			var res;
			var params = {
				action : 'send-mail',
				data : {}
			};
			$.ajax({
				async : false, //禁止异步
				url : "/ddcomeNew/goodLuckToDd/forend",
				type : "post",
				data : {
					params : JSON.stringify(params)
				},
				dataType : "json",
				success : function(json) {
					res = json;
				},
				error : function(json) {
					res = json;
				}
			});
			return res;
		}
		
		function commentByQQ() {
			var qqContent = $("#qq-comment-content").val().trim();
			if(qqContent=="") {
				return;
			}
			/**
			 * 回复函数
			 * 需要四个参数：
			 * 1.被回复数据的belongTo
			 * 2.被回复数据的id，speakWith的值一定等于这个值
			 * 3.被回复数据的speaker
			 * 4.该文章的编号aid
			 */
			var id = GetQueryString("id");
			replyByQQ(-1,-1,id,userInfo.name_qq,qqContent);//belongTo, id, aid, speaker
		}
		
		
		
		/**
		* 邮箱的评论按钮
		*/
		function commentByEmail() {
			var id = GetQueryString("id");
			var email = $("#mail-name").val();
			//屏蔽提示信息
			$("#identy-warn").css("display","none");
			$("#mail-warn").css("display","none");
			//检验邮箱
			if ($("#mail-name").val().trim()=="") {
				$("#mail-warn").html('<i class="fa fa-exclamation-circle" aria-hidden="true"></i>不能为空哦 ！');
				$("#mail-warn").css("display","block");
				return;
			}
			//获取验证码
			var identyCode = $("#identy-code-input").val().trim();
			//获取评论内容
			var contentByEmail = $("#email-comment-content").val().trim();
			//验证开始
			if(identyCode=="") {
				$("#identy-warn").html('<i class="fa fa-exclamation-circle" aria-hidden="true"></i>不能为空哦 ！');
				$("#identy-warn").css("display","block");
				return;
			}
			if(contentByEmail=='') {
				$("#identy-warn").html('<i class="fa fa-exclamation-circle" aria-hidden="true"></i>请输入留言内容 ！');
				$("#identy-warn").css("display","block");
				return;
			}
			if(!isRightIdentifyCode(identyCode,email)) {
				$("#identy-warn").html('<i class="fa fa-exclamation-circle" aria-hidden="true"></i>验证码错误！');
				$("#identy-warn").css("display","block");
				return;
			}
			//验证结束 
			replyByEmail(-1,-1,id,userInfo.name_qq,contentByEmail)//(-1,-1,id,userInfo.name_qq,qqContent)
			
		}

		function GetQueryString(name) {
			var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
			var r = window.location.search.substr(1).match(reg);
			if (r != null)
				return unescape(r[2]);
			return null;
		}

		/*
		function showVisitorLoginDiv() {
			console.log("come in showVisitorLoginDiv()");
			times++;
			if(times%2==0) {
				$("#visitor-login-div").hide();
			} else {
				$("#visitor-login-div").show();
			}
			
		}
		 */

		/**
		$(function() {
			$('a.media').media({
				width : 700,
				height : 930
			});
			$(".media").css("background-color", "#F3F3F3");
			$("#download").remove();
			$("#print").remove();
		});
		 */
        function showLoadingBooks() {
            $("#loading-books").hide();
            $("#books-ul").show();
        }

        function hideLoadingBooks() {
            $("#loading-books").show();
            $("#books-ul").hide();
        }

        function loadBooksData(data) {
            $("#books-ul").empty();
            var cont="";
            for(var i=0; i<data.length; i++) {
                cont += '<li>'+data[i].book_name+'</li>';
            }
            $("#books-ul").append($(cont));
        }

        function findBooks() {
            var res;
            var params = {
                action : 'all-books',
                data : {}
            };
            $.ajax({
                async : true, //异步
                url : "/ddcomeNew/goodLuckToDd/forend",
                type : "post",
                data : {
                    params : JSON.stringify(params)
                },
                dataType : "json",
                success : function(jsonData) {
                    /*
                    $("#message").html(json.message);
                    //成功跳转
                    if(json.status.toString() == '1'){
                         window.location.href="index.html";
                    }
                     */
                    loadBooksData(jsonData);
                    showLoadingBooks();//显示
                },
                error : function(jsonData) {
                    /*
                    alert(json.message);
                    $("#message").html(json.message);
                     */
                    res = jsonData;
                }
            });
        }
	</script>
	<!-- 由于IP请求第三方服务，故而放置于最后实现 -->
	<!-- <script src="./script-packages/js/own/ip.own.js"></script> -->
</body>
</html>
